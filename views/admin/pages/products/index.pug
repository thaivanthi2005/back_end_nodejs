extends ../../layouts/default.pug
include ../../mixins/filterStatus.pug
include ../../mixins/search.pug
include ../../mixins/pagination.pug
block main
    h1.mb-4 DANH SÁCH SẢN PHẨM

        .card.mb-3
            .card-header Bộ lọc và Tìm kiếm
            .card-body
                .row
                    .col-6
                        +filterStatus(category)
                    .col-6
                        +search(keyword)

            
        .card.mb-3
            .card-header Danh sách sản phẩm
            .card-body
                
                .card.mb-3
                    .card-header Danh sách
                    .card-body
                        form(
                            action=`${prefixAdmin}/products/change-multi?_method=PATCH`
                            method="POST"
                            form-change-multi
                            )
                            .d-flex.align-items-start
                                .form-group
                                select(name="type" class="form-control")
                                    option(disabled selected) -- Chọn hành động --
                                    option(value="InStock") Còn hàng
                                    option(value="OutStock") Hết hàng
                                    option(value="delete-all") Xóa tất cả
                                .form-group
                                input(
                                    type="text"
                                    name="ids"
                                    value=""
                                    class="form-control"
                                )
                                button(type="submit" class="btn btn-primary") Áp dụng


                table(class="table table-hover table-sm"
                checkbox-multi)
                    thead.thead-dark
                        tr
                            th
                                input(type="checkbox", name="checkall")
                            th.text-center STT
                            th.text-center Hình ảnh
                            th Tiêu đề
                            th.text-center Giá
                            th.text-center Trạng thái
                            th.text-center Hành động
                    tbody
                        each val,index in products
                            tr
                                td
                                    input(
                                        type="checkbox",
                                        name="id",
                                        value=val.id
                                    )
                                td.text-center #{index + 1}
                                td.text-center
                                    img.img-thumbnail(
                                        width="80",
                                        src=val.thumbnail
                                    )
                                td #{val.title}
                                td.text-center #{val.price}
                                td
                                    if(val.status == "InStock")
                                        a(href="javascript:;"
                                        data-status = "InStock"
                                        data-id = val.id
                                        button-change-status
                                        class="badge badge-success") Còn hàng
                                    else
                                        a(href="javascript:;"
                                        data-status = "OutStock"
                                        data-id = val.id
                                        button-change-status
                                        class="badge badge-danger") Hết hàng
                                td.text-center
                                    button(class="btn btn-warning btn-sm") Sửa
                                    button(class="btn btn-danger btn-sm ml-1",
                                    data-id = val.id,
                                    button-delete) Xóa
    +pagination(pagination)

    form(
        action="",
        method="POST",
        id="form-change-status",
        data-path=`${prefixAdmin}/products/change-status`
    )

    form(
        action="",
        method="POST",
        id="form-delete-product",
        data-path=`${prefixAdmin}/products/delete`
    )
    
    script(src="/admin/js/products.js")